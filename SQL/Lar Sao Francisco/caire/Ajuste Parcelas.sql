UPDATE SE2010 SET E2_PARCELA = 'A0' WHERE E2_PARCELA = '100' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A1' WHERE E2_PARCELA = '101' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A2' WHERE E2_PARCELA = '102' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A3' WHERE E2_PARCELA = '103' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A4' WHERE E2_PARCELA = '104' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A5' WHERE E2_PARCELA = '105' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A6' WHERE E2_PARCELA = '106' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A7' WHERE E2_PARCELA = '107' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A8' WHERE E2_PARCELA = '108' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'A9' WHERE E2_PARCELA = '109' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B0' WHERE E2_PARCELA = '110' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B1' WHERE E2_PARCELA = '111' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B2' WHERE E2_PARCELA = '112' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B3' WHERE E2_PARCELA = '113' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B4' WHERE E2_PARCELA = '114' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B5' WHERE E2_PARCELA = '115' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B6' WHERE E2_PARCELA = '116' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B7' WHERE E2_PARCELA = '117' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B8' WHERE E2_PARCELA = '118' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'B9' WHERE E2_PARCELA = '119' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCELA = 'C1' WHERE E2_PARCELA = '120' AND D_E_L_E_T_=' ';
UPDATE SE5010 SET E5_PARCELA = SUBSTR(E5_PARCELA,2,2) WHERE LENGTH(TRIM(E5_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND SUBSTR(E5_PARCELA,1,1) = '0';
UPDATE SE2010 SET E2_PARCELA = SUBSTR(E2_PARCELA,2,2) WHERE LENGTH(TRIM(E2_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND SUBSTR(E2_PARCELA,1,1) = '0';
UPDATE SE2010 SET E2_PARCELA = SUBSTR(E2_PARCELA,2,2) WHERE LENGTH(TRIM(E2_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND SUBSTR(E2_PARCELA,1,1) = '0';
UPDATE SE2010 SET E2_PARCPIS = SUBSTR(E2_PARCPIS,2,2) WHERE LENGTH(TRIM(E2_PARCPIS)) > 2 AND SUBSTR(E2_PARCPIS,1,1) = '0' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCSLL = SUBSTR(E2_PARCSLL,2,2) WHERE LENGTH(TRIM(E2_PARCSLL)) > 2 AND SUBSTR(E2_PARCSLL,1,1) = '0' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCCOF = SUBSTR(E2_PARCCOF,2,2) WHERE LENGTH(TRIM(E2_PARCCOF)) > 2 AND SUBSTR(E2_PARCCOF,1,1) = '0' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCIR  = SUBSTR(E2_PARCIR,2,2)  WHERE LENGTH(TRIM(E2_PARCIR )) > 2 AND SUBSTR(E2_PARCIR ,1,1) = '0' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCINS = SUBSTR(E2_PARCINS,2,2) WHERE LENGTH(TRIM(E2_PARCINS)) > 2 AND SUBSTR(E2_PARCINS,1,1) = '0' AND D_E_L_E_T_=' ';
UPDATE SE2010 SET E2_PARCISS = SUBSTR(E2_PARCISS,2,2) WHERE LENGTH(TRIM(E2_PARCISS)) > 2 AND SUBSTR(E2_PARCISS,1,1) = '0' AND D_E_L_E_T_=' ';
UPDATE SE1010 SET E1_PARCELA = SUBSTR(E1_PARCELA,2,2) WHERE LENGTH(TRIM(E1_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND SUBSTR(E1_PARCELA,1,1) = '0';
UPDATE SE5010 SET E5_DOCUMEN = REPLACE(E5_DOCUMEN,SUBSTR(E5_DOCUMEN,13,3),TRIM(SUBSTR(E5_DOCUMEN,13,3))) WHERE E5_DOCUMEN <> ' ' AND D_E_L_E_T_=' ' AND E5_TIPODOC IN ('RA','PA','CP') AND E5_DATA >= '20200220' AND TRIM(SUBSTR(E5_DOCUMEN,13,3)) <> ' ' AND LENGTH(TRIM(E5_DOCUMEN)) > 20;
UPDATE SE2010 SET E2_TITPAI = REPLACE(E2_TITPAI,SUBSTR(E2_TITPAI,13,3),SUBSTR(E2_TITPAI,13,2)) WHERE LENGTH(TRIM(E2_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND E2_TITPAI <> ' ' AND SUBSTR(E2_TITPAI,13,3) <> ' ';

UPDATE SE2010 SET E2_PARCELA = CASE WHEN SUBSTR(E2_PARCELA,2,1) = '0' THEN 'D'||SUBSTR(E2_PARCELA,3,1) ELSE SUBSTR(E2_PARCELA,2,2) END WHERE R_E_C_N_O_ IN (SELECT A.R_E_C_N_O_ FROM SE2010 A
WHERE LENGTH(TRIM(A.E2_PARCELA)) > 2  AND A.D_E_L_E_T_=' '
AND A.E2_FILIAL||A.E2_PREFIXO||A.E2_NUM||SUBSTR(A.E2_PARCELA,2,2)||A.E2_TIPO||A.E2_FORNECE||A.E2_LOJA 
IN (SELECT B.E2_FILIAL||B.E2_PREFIXO||B.E2_NUM||TRIM(B.E2_PARCELA)||B.E2_TIPO||B.E2_FORNECE||B.E2_LOJA FROM SE2010 B WHERE LENGTH(TRIM(B.E2_PARCELA)) = 2 AND B.D_E_L_E_T_=' '));

SELECT E1_FILIAL, E1_PREFIXO, E1_NUM, E1_PARCELA, SUBSTR(E1_PARCELA,2,2), E1_TIPO, E1_NATUREZ, E1_CLIENTE, E1_LOJA, E1_EMISSAO, E1_VALOR FROM SE1010 WHERE LENGTH(TRIM(E1_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND SUBSTR(E1_PARCELA,1,1) = '0';

SELECT E2_FILIAL, E2_PREFIXO, E2_NUM, E2_PARCELA, E2_TIPO, E2_TITPAI FROM SE2010 WHERE LENGTH(TRIM(E2_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND E2_TITPAI <> ' ' AND SUBSTR(E2_TITPAI,13,3) <> '  ';

SELECT E5_FILIAL, E5_PREFIXO, E5_NUMERO, E5_PARCELA, SUBSTR(E5_PARCELA,2,2), E5_TIPO, E5_NATUREZ, E5_CLIFOR, E5_LOJA, E5_DATA, E5_VALOR FROM SE5010 WHERE LENGTH(TRIM(E5_PARCELA)) > 2 AND D_E_L_E_T_=' ' AND SUBSTR(E5_PARCELA,1,1) = '0';

SELECT A.E2_FILIAL,A.E2_PREFIXO,A.E2_NUM,A.E2_PARCELA,A.E2_TIPO,A.E2_FORNECE,A.E2_LOJA, A.R_E_C_N_O_, A.E2_TITPAI, A.D_E_L_E_T_ FROM SE2010 A
WHERE LENGTH(TRIM(A.E2_PARCELA)) > 2  AND A.D_E_L_E_T_=' '
AND A.E2_FILIAL||A.E2_PREFIXO||A.E2_NUM||SUBSTR(A.E2_PARCELA,2,2)||A.E2_TIPO||A.E2_FORNECE||A.E2_LOJA 
IN (SELECT B.E2_FILIAL||B.E2_PREFIXO||B.E2_NUM||TRIM(B.E2_PARCELA)||B.E2_TIPO||B.E2_FORNECE||B.E2_LOJA FROM SE2010 B WHERE LENGTH(TRIM(B.E2_PARCELA)) = 2 AND B.D_E_L_E_T_=' ')
ORDER BY A.E2_FILIAL,A.E2_PREFIXO,A.E2_NUM,A.E2_PARCELA,A.E2_TIPO,A.E2_FORNECE,A.E2_LOJA;


