SELECT AF8.AF8_FILIAL FILIAL
	,AF8.AF8_PROJET PROJETO
	,AF8.AF8_DESCRI DESC_PROJETO
	,AF9.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF9.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(to_date(AF8_START, 'YYYYMMDD')) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF8
INNER JOIN AF9010 AF9 ON AF9.AF9_FILIAL = AF8.AF8_FILIAL
	AND AF9.AF9_PROJET = AF8.AF8_PROJET
	AND AF9.AF9_REVISA = AF8.AF8_REVISA
	AND AF9.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF8.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF8.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF9.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF8.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(to_date(AF8.AF8_START, 'YYYYMMDD'))
    LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF8.D_E_L_E_T_ = ' '
GROUP BY AF8.AF8_FILIAL
	,AF8.AF8_PROJET
	,AF8.AF8_DESCRI
	,AF9.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF9.AF9_DESCRI
	,LAST_DAY(to_date(AF8_START, 'YYYYMMDD'))
	,AF8.AF8_START
	,AF8.AF8_REVISA
,F.A2_NOME 

UNION ALL

SELECT AF82.AF8_FILIAL FILIAL
	,AF82.AF8_PROJET PROJETO
	,AF82.AF8_DESCRI DESC_PROJETO
	,AF92.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF92.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF82.AF8_START, 'YYYYMMDD'), 1)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF82
INNER JOIN AF9010 AF92 ON AF92.AF9_FILIAL = AF82.AF8_FILIAL
	AND AF92.AF9_PROJET = AF82.AF8_PROJET
	AND AF92.AF9_REVISA = AF82.AF8_REVISA
	AND AF92.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF82.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF82.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF92.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF82.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(to_date(AF82.AF8_START, 'YYYYMMDD'))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF82.AF8_START, 'YYYYMMDD'), 1))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF82.D_E_L_E_T_ = ' '
GROUP BY AF82.AF8_FILIAL
	,AF82.AF8_PROJET
	,AF82.AF8_DESCRI
	,AF92.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF92.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF82.AF8_START, 'YYYYMMDD'), 1))
	,AF82.AF8_START
	,AF82.AF8_REVISA
  ,F.A2_NOME 

UNION ALL

SELECT AF83.AF8_FILIAL FILIAL
	,AF83.AF8_PROJET PROJETO
	,AF83.AF8_DESCRI DESC_PROJETO
	,AF93.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF93.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF83.AF8_START, 'YYYYMMDD'), 2)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF83
INNER JOIN AF9010 AF93 ON AF93.AF9_FILIAL = AF83.AF8_FILIAL
	AND AF93.AF9_PROJET = AF83.AF8_PROJET
	AND AF93.AF9_REVISA = AF83.AF8_REVISA
	AND AF93.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF83.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF83.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF93.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF83.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF83.AF8_START, 'YYYYMMDD'), 1))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF83.AF8_START, 'YYYYMMDD'), 2))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF83.D_E_L_E_T_ = ' '
GROUP BY AF83.AF8_FILIAL
	,AF83.AF8_PROJET
	,AF83.AF8_DESCRI
	,AF93.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF93.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF83.AF8_START, 'YYYYMMDD'), 2))
	,AF83.AF8_START
	,AF83.AF8_REVISA
  ,F.A2_NOME 

UNION ALL

SELECT AF84.AF8_FILIAL FILIAL
	,AF84.AF8_PROJET PROJETO
	,AF84.AF8_DESCRI DESC_PROJETO
	,AF94.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF94.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF84.AF8_START, 'YYYYMMDD'), 3)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF84
INNER JOIN AF9010 AF94 ON AF94.AF9_FILIAL = AF84.AF8_FILIAL
	AND AF94.AF9_PROJET = AF84.AF8_PROJET
	AND AF94.AF9_REVISA = AF84.AF8_REVISA
	AND AF94.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF84.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF84.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF94.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF84.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF84.AF8_START, 'YYYYMMDD'), 2))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF84.AF8_START, 'YYYYMMDD'), 3))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF84.D_E_L_E_T_ = ' '
GROUP BY AF84.AF8_FILIAL
	,AF84.AF8_PROJET
	,AF84.AF8_DESCRI
	,AF94.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF94.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF84.AF8_START, 'YYYYMMDD'), 3))
	,AF84.AF8_START
	,AF84.AF8_REVISA
  ,F.A2_NOME 

UNION ALL

SELECT AF85.AF8_FILIAL FILIAL
	,AF85.AF8_PROJET PROJETO
	,AF85.AF8_DESCRI DESC_PROJETO
	,AF95.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF95.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF85.AF8_START, 'YYYYMMDD'), 4)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF85
INNER JOIN AF9010 AF95 ON AF95.AF9_FILIAL = AF85.AF8_FILIAL
	AND AF95.AF9_PROJET = AF85.AF8_PROJET
	AND AF95.AF9_REVISA = AF85.AF8_REVISA
	AND AF95.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF85.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF85.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF95.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF85.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF85.AF8_START, 'YYYYMMDD'), 3))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF85.AF8_START, 'YYYYMMDD'), 4))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF85.D_E_L_E_T_ = ' '
GROUP BY AF85.AF8_FILIAL
	,AF85.AF8_PROJET
	,AF85.AF8_DESCRI
	,AF95.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF95.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF85.AF8_START, 'YYYYMMDD'), 4))
	,AF85.AF8_START
	,AF85.AF8_REVISA
  ,F.A2_NOME 

UNION ALL

SELECT AF86.AF8_FILIAL FILIAL
	,AF86.AF8_PROJET PROJETO
	,AF86.AF8_DESCRI DESC_PROJETO
	,AF96.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF96.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF86.AF8_START, 'YYYYMMDD'), 5)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF86
INNER JOIN AF9010 AF96 ON AF96.AF9_FILIAL = AF86.AF8_FILIAL
	AND AF96.AF9_PROJET = AF86.AF8_PROJET
	AND AF96.AF9_REVISA = AF86.AF8_REVISA
	AND AF96.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF86.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF86.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF96.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF86.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF86.AF8_START, 'YYYYMMDD'), 4))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF86.AF8_START, 'YYYYMMDD'), 5))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0  LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF86.D_E_L_E_T_ = ' '
GROUP BY AF86.AF8_FILIAL
	,AF86.AF8_PROJET
	,AF86.AF8_DESCRI
	,AF96.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF96.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF86.AF8_START, 'YYYYMMDD'), 5))
	,AF86.AF8_START
	,AF86.AF8_REVISA
  ,F.A2_NOME

UNION ALL

SELECT AF87.AF8_FILIAL FILIAL
	,AF87.AF8_PROJET PROJETO
	,AF87.AF8_DESCRI DESC_PROJETO
	,AF97.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF97.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF87.AF8_START, 'YYYYMMDD'), 6)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF87
INNER JOIN AF9010 AF97 ON AF97.AF9_FILIAL = AF87.AF8_FILIAL
	AND AF97.AF9_PROJET = AF87.AF8_PROJET
	AND AF97.AF9_REVISA = AF87.AF8_REVISA
	AND AF97.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF87.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF87.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF97.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF87.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF87.AF8_START, 'YYYYMMDD'), 5))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF87.AF8_START, 'YYYYMMDD'), 6))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF87.D_E_L_E_T_ = ' '
GROUP BY AF87.AF8_FILIAL
	,AF87.AF8_PROJET
	,AF87.AF8_DESCRI
	,AF97.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF97.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF87.AF8_START, 'YYYYMMDD'), 6))
	,AF87.AF8_START
	,AF87.AF8_REVISA
  ,F.A2_NOME

UNION ALL

SELECT AF88.AF8_FILIAL FILIAL
	,AF88.AF8_PROJET PROJETO
	,AF88.AF8_DESCRI DESC_PROJETO
	,AF98.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF98.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF88.AF8_START, 'YYYYMMDD'), 7)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF88
INNER JOIN AF9010 AF98 ON AF98.AF9_FILIAL = AF88.AF8_FILIAL
	AND AF98.AF9_PROJET = AF88.AF8_PROJET
	AND AF98.AF9_REVISA = AF88.AF8_REVISA
	AND AF98.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF88.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF88.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF98.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF88.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF88.AF8_START, 'YYYYMMDD'), 6))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF88.AF8_START, 'YYYYMMDD'), 7))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF88.D_E_L_E_T_ = ' '
GROUP BY AF88.AF8_FILIAL
	,AF88.AF8_PROJET
	,AF88.AF8_DESCRI
	,AF98.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF98.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF88.AF8_START, 'YYYYMMDD'), 7))
	,AF88.AF8_START
	,AF88.AF8_REVISA
  ,F.A2_NOME

UNION ALL

SELECT AF89.AF8_FILIAL FILIAL
	,AF89.AF8_PROJET PROJETO
	,AF89.AF8_DESCRI DESC_PROJETO
	,AF99.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF99.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF89.AF8_START, 'YYYYMMDD'), 8)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF89
INNER JOIN AF9010 AF99 ON AF99.AF9_FILIAL = AF89.AF8_FILIAL
	AND AF99.AF9_PROJET = AF89.AF8_PROJET
	AND AF99.AF9_REVISA = AF89.AF8_REVISA
	AND AF99.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF89.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF89.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF99.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF89.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF89.AF8_START, 'YYYYMMDD'), 7))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF89.AF8_START, 'YYYYMMDD'), 8))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF89.D_E_L_E_T_ = ' '
GROUP BY AF89.AF8_FILIAL
	,AF89.AF8_PROJET
	,AF89.AF8_DESCRI
	,AF99.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF99.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF89.AF8_START, 'YYYYMMDD'), 8))
	,AF89.AF8_START
	,AF89.AF8_REVISA
  ,F.A2_NOME

UNION ALL

SELECT AF810.AF8_FILIAL FILIAL
	,AF810.AF8_PROJET PROJETO
	,AF810.AF8_DESCRI DESC_PROJETO
	,AF910.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF910.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF810.AF8_START, 'YYYYMMDD'), 9)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF810
INNER JOIN AF9010 AF910 ON AF910.AF9_FILIAL = AF810.AF8_FILIAL
	AND AF910.AF9_PROJET = AF810.AF8_PROJET
	AND AF910.AF9_REVISA = AF810.AF8_REVISA
	AND AF910.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF810.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF810.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF910.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF810.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF810.AF8_START, 'YYYYMMDD'), 8))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF810.AF8_START, 'YYYYMMDD'), 9))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF810.D_E_L_E_T_ = ' '
GROUP BY AF810.AF8_FILIAL
	,AF810.AF8_PROJET
	,AF810.AF8_DESCRI
	,AF910.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF910.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF810.AF8_START, 'YYYYMMDD'), 9))
	,AF810.AF8_START
	,AF810.AF8_REVISA
  ,F.A2_NOME

UNION ALL

SELECT AF811.AF8_FILIAL FILIAL
	,AF811.AF8_PROJET PROJETO
	,AF811.AF8_DESCRI DESC_PROJETO
	,AF911.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF911.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF811.AF8_START, 'YYYYMMDD'), 10)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF811
INNER JOIN AF9010 AF911 ON AF911.AF9_FILIAL = AF811.AF8_FILIAL
	AND AF911.AF9_PROJET = AF811.AF8_PROJET
	AND AF911.AF9_REVISA = AF811.AF8_REVISA
	AND AF911.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF811.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF811.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF911.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF811.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF811.AF8_START, 'YYYYMMDD'), 9))
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF811.AF8_START, 'YYYYMMDD'), 10))
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF811.D_E_L_E_T_ = ' '
GROUP BY AF811.AF8_FILIAL
	,AF811.AF8_PROJET
	,AF811.AF8_DESCRI
	,AF911.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF911.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF811.AF8_START, 'YYYYMMDD'), 10))
	,AF811.AF8_START
	,AF811.AF8_REVISA
  ,F.A2_NOME

UNION ALL

SELECT AF812.AF8_FILIAL FILIAL
	,AF812.AF8_PROJET PROJETO
	,AF812.AF8_DESCRI DESC_PROJETO
	,AF912.AF9_TAREFA TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD') EMISSAO_PEDIDO
	,coalesce(C7_NUM, '') PEDIDO
  ,F.A2_NOME FORNECEDOR
	,AF912.AF9_DESCRI DESC_TAREFA
	,LAST_DAY(ADD_MONTHS(to_date(AF812.AF8_START, 'YYYYMMDD'), 11)) MES
	,SUM(NVL((SC7.C7_QUANT-SC7.C7_QUJE) * SC7.C7_PRECO, 0)) TOTAL_PEDIDO
FROM AF8010 AF812
INNER JOIN AF9010 AF912 ON AF912.AF9_FILIAL = AF812.AF8_FILIAL
	AND AF912.AF9_PROJET = AF812.AF8_PROJET
	AND AF912.AF9_REVISA = AF812.AF8_REVISA
	AND AF912.D_E_L_E_T_ = ' '
INNER JOIN AJ7010 AJ7 ON AJ7.AJ7_FILIAL = AF812.AF8_FILIAL
	AND AJ7.AJ7_PROJET = AF812.AF8_PROJET
	AND AJ7.AJ7_TAREFA = AF912.AF9_TAREFA
	AND AJ7.AJ7_REVISA = AF812.AF8_REVISA
	AND AJ7.D_E_L_E_T_ = ' '
INNER JOIN SC7010 SC7 ON SC7.C7_FILIAL = AJ7.AJ7_FILIAL
	AND SC7.C7_NUM = AJ7.AJ7_NUMPC
	AND SC7.C7_ITEM = AJ7.AJ7_ITEMPC
	AND SC7.C7_PRODUTO = AJ7.AJ7_COD
	AND SC7.D_E_L_E_T_ = ' ' AND SC7.C7_ENCER <> 'E'
	AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') > LAST_DAY(ADD_MONTHS(to_date(AF812.AF8_START, 'YYYYMMDD'), 10))
	/*AND to_date(NVL(SC7.C7_X_DTCON,SC7.C7_EMISSAO), 'YYYYMMDD') <= LAST_DAY(ADD_MONTHS(to_date(AF812.AF8_START, 'YYYYMMDD'), 11))*/
  AND (
				SELECT count(*)
				FROM SD1010 SD1
				WHERE D1_FILIAL = SC7.C7_FILIAL
					AND D1_COD = C7_PRODUTO
					AND D1_PEDIDO = SC7.C7_NUM
					AND SD1.D1_ITEMPC = SC7.C7_ITEM
					AND SD1.D_E_L_E_T_ = ' '
					AND TRIM(SD1.D1_X_DTPMS) <> ' '
				) = 0
          LEFT OUTER JOIN SA2010 F ON F.D_E_L_E_T_ = ' '
  AND F.A2_COD = SC7.C7_FORNECE 
  AND F.A2_LOJA = SC7.C7_LOJA
  and substr(F.A2_FILIAL,1,2) = substr(C7_FILIAL,1,2)
WHERE AF812.D_E_L_E_T_ = ' '
GROUP BY AF812.AF8_FILIAL
	,AF812.AF8_PROJET
	,AF812.AF8_DESCRI
	,AF912.AF9_TAREFA
	,TO_DATE(coalesce(C7_X_DTCON, C7_EMISSAO, ''), 'YYYYMMDD')
	,coalesce(C7_NUM, '')
	,AF912.AF9_DESCRI
	,LAST_DAY(ADD_MONTHS(to_date(AF812.AF8_START, 'YYYYMMDD'), 11))
	,AF812.AF8_START
	,AF812.AF8_REVISA
  ,F.A2_NOME